/*
html5版的视频播放器
author zsdroid
*/
var Html5VideoPlayer=function(a){this.vWidth=a.vWidth||200;this.vHeight=a.vHeight||100;this.vSrc=a.vSrc||"";this.vZIndex=a.vZIndex||100;this.vPoster=a.vPoster||"";this.vShowLightSwitch=a.vShowLightSwitch!=undefined?a.vShowLightSwitch:true;this.vHaveLight={onText:"开灯",onIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAnlJREFUOE9tk01oWkEQx1ftoemlXyAEcioNtBGhPQZKEHrPJSiigpDY0gTUKhT1JFERcggGT1WQ6KHaSyu1KthopfEjJlVbjKgFBTWCX4nEg+hBfZ19VSu8LPzYeTM7/5l9u0sjCALh4XK5yJlOpyMajfYEzKfj8fgugEajUXc4HOb7/X5hMBiQ65RKJTkjLIBxOp0YGgit+Xw+Rblcdl9eXkYrlUook8l8BP9bs9m8tr+/TwNmeTPDbrcjh8Ox4vF4lL1e70+n08k2m82f2Wz2WyQS8V9cXJzZbDaFTqdb0Wq1VAGr1YosFgsXKnuvr6/z7XY71Wq1kvl8PnR0dPT59PQ0kMvl3Gq1mqtSqagCBwcHyGQySbrdbhYSyeRarRZPpVL+QCDwKRaLecB3JpPJXkmlUqqAwWBAer1+a1L1O66Mk4PBoBt3kEwm/dBVXCKRbMGgCmg0GgTtrR8fHzvS6fQPnIQr4zmRSHwtlUpRiH0QiUTrQqGQKqBQKJBcLl8CkZ1qtXoSj8d90Wj0C1T2FQqFEPzQs+3t7R0ej7cE3CwA+0Obm5urRqNRAwkZ2EawWCyGrq6usru7uxoul7uKk28UEAgEaAKdz+dvhMNhJxzdCXQTwzYkbwB0AGGm92dmTAOTeXlvb+9do9H4Xa/Xf2Eb/MvzaygCLBaLVJ6wIBaL38CJnOOtYBv8C9M4k8mkdvDvYiPE4XBIETab/drr9RJwNwgGg/EeF8BMB6WDWWQiggXgBxJut5sUmI/Pv6H/rcBDhMBt4D6wiAXg/InDw8OpwCL4HwB38KO9qQMGBO4Bj4Bn8KRfAAHgHL5fAs+Bx8BD4NZU4C9hkBlGyPjr5wAAAABJRU5ErkJggg==",offText:"关灯",offIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAm5JREFUeNp0U81vElEQf+/tB9sFSiFCKSTWiolA7cdBYzTRYLQ3z8ZrD5oYD3r10Hjy4B/QkyZ60IMfJxOT2sZmQ4ipacTSSAmliBzED6CUApWF/XAesC00dJLJzM7M7/dmdt7Duq4jKq8eYmQIxsgPJgApO82C3QWNKypKqGq7ZvZxG8eiXqEsl23u4Nnx0J2QzTPqrddzeuln5lcy8jaynUt7IL9MOQ0AMRxVQ0jTUdA2cub8ldlndx3HA+MIq2JdzvGqkPVfuPng9qD79EXoYqqpHJy4T6ABAbQ3NXnt3lVVqxFNazRpgwwjIEUpK6WdFTw9cysEBOcU7YBgfwSlPduxIY/PpygVGbh1AGqy/AfImxgIVYd3bLShoGFdP5qAbcgFpba3qWJMWuBqdYslxEQ4bggjnWlCX6QvQWeufDYeSQ56yXS1mvxHT2YYnphMHmw2n+R+bKwlgeB3918n3R0AyaeV9y+/mgcm6jzv5AXBzYiij5jNpxgTd6K+/GY+Bj9b6nTbS4Da+07vFIufl17ML7iHrwtWa5CI4hgBa3r35NHibikfgZrNvh2UqwhV9lpdLKbj0fT3b/F1nndxLGthtmJf1jOJVQpcOHRveu9BR1U4JZxY/bgBYI5hLDz1oSRMy44kkGI98VQ2GZUxZjAhLKY+jRnJ5x/6bEFaa+uNGRdyOp21cJRkJiMDrlQqheaeyvZLE6hm1HXL4beAXi/9RaFQELwiCgT8qNHgUT9gvy1QXwC1S5I0QgOFQgGVy3kjT2MOULEbh43njGFgMNZO0SB8W8DOgXqg5j7YbdAKaIkuDWKtq/dfgAEARTYbucps2QYAAAAASUVORK5CYII=",}};Html5VideoPlayer.prototype.CallBack=function(a){this.vCallBack=a};var FullScreen=function(a){var b=false;a.addEventListener("dblclick",function(){if(!b){if(a.requestFullscreen){a.requestFullscreen()}else{if(a.mozRequestFullScreen){a.mozRequestFullScreen()}else{if(a.webkitRequestFullScreen){a.webkitRequestFullScreen()}else{if(a.msRequestFullscreen){a.msRequestFullscreen()}}}}}else{if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}}}}}b=!b},false)};var LightSwitch=function(e,g){var i="shadow_"+new Date().getTime();var c=""+"#"+i+"{"+"		position:absolute;"+"		background-color:gray;"+"		left:0;"+"		top:0;"+"		width:100%;"+"		height:100%;"+"		z-index:"+e.vZIndex+";"+"}";var a=document.createElement("style");a.innerHTML=c;document.head.appendChild(a);var h=document.createElement("div");h.id=i;h.style.display="none";g.appendChild(h);var b='<img src="'+e.vHaveLight.offIcon+'"/>'+e.vHaveLight.offText;var f='<img src="'+e.vHaveLight.onIcon+'"/>'+e.vHaveLight.onText;var d=document.createElement("span");d.id="light_"+new Date().getTime();d.className="close-light";d.style.top=20;d.style.position="absolute";d.style["z-index"]=e.vZIndex+2;d.style.left=e.vWidth;d.innerHTML=b;d.addEventListener("click",function(){if(this.className=="close-light"){this.innerHTML=f;this.className="open-light";h.style.display="block"}else{this.innerHTML=b;this.className="close-light";h.style.display="none"}});g.appendChild(d)};Html5VideoPlayer.prototype.Create=function(f){this.videoPlayerQuerySelector=document.querySelector(f);var b=document.createElement("div");b.id="Html5VideoPlayer_"+new Date().getTime();this.videoPlayerQuerySelector.appendChild(b);var e=document.createElement("video");e.id="video_"+new Date().getTime();e.innerHTML="您的浏览器不支持html5 video!";e.loop=1;e.controls=1;e.style.position="absolute";e.style["z-index"]=this.vZIndex+2;if(this.vPoster!=""){e.poster=this.vPoster}e.width=this.vWidth;e.height=this.vHeight;e.src=this.vSrc;b.appendChild(e);FullScreen(e);this.vShowLightSwitch&&LightSwitch(this,b);document.addEventListener("keydown",function(){var j=h.GetCurrentTime();var i=h.GetVolume();switch(event.keyCode){case 37:a.SetCurrentTime(j-5);break;case 39:a.SetCurrentTime(j+5);break;case 38:a.SetVolume(i+0.1);break;case 40:a.SetVolume(i-0.1);break;case 32:h.GetInfo("paused")?a.SetPlay():a.SetPause();break}},false);if(e.error!=null){var d={1:"用户终止",2:"网络错误",3:"解码错误",4:"URL无效",};console.log(e.error.code,d[e.error.code]);return}var c=this;var h={GetInfo:function(i){i=i||null;var j={paused:e.paused,ended:e.ended,duration:e.duration,};if(i!=null&&j[i]!=undefined){return j[i]}return j},GetVolume:function(){return e.volume},GetCurrentTime:function(){return e.currentTime},};var g=function(i){e.addEventListener(i,function(){if(c.vCallBack!=undefined&&c.vCallBack[i]!=undefined){c.vCallBack[i].call(h)}},false)};g("loadstart");g("suspend");g("abort");g("progress");g("error");g("stalled");g("play");g("pause");g("loadedmetadata");g("waiting");g("playing");g("canplay");g("canplaythrough");g("seeking");g("seeked");g("timeupdate");g("ended");g("ratechange");g("durationchange");g("volumechange");var a={SetCurrentTime:function(i){var i=i!=undefined?i:-1;if(i!=-1){e.currentTime=i}},SetVolume:function(i){var i=i||0;if(i!=0){e.volume=i}},SetMuted:function(i){var i=i||true;e.muted=i},SetPause:function(){e.pause()},SetPlay:function(){e.play()},};return a};
